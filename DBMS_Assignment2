
 /*1. Find out the number of documentaries with deleted scenes.*/
 select count(*) 
 from film inner join film_category on film.film_id=film_category.film_id
 where Instr(film.special_features,"Deleted Scenes")!=0 and category_id in
 ( Select category_id from category where category.name="Documentary");
 
 /*2. Find out the number of sci-fi movies rented by the store managed by Jon Stephens.*/
  select count(distinct film_list.fid)
  from film_list inner join (select distinct film_id,inventory_id,store_id from inventory) inven on film_list.fid=inven.film_id
  inner join store on store.store_id=inven.store_id 
  where store.manager_staff_id in 
  (select staff_id from staff 
  where first_name="Jon" and last_name="Stephens")
  and film_list.category="Sci-Fi";
  
  /*3. Find out the total sales from Animation movies.*/
 select sum(price)
 from film_list where category="Animation";
 select total_sales from sales_by_film_category where category="Animation";
 
  /* 4. Find out the top 3 rented category of movies by “PATRICIA JOHNSON”. */
 SELECT film_list.category, count(film_list.category)
FROM customer
JOIN rental
ON customer.customer_id = rental.customer_id
JOIN inventory
ON rental.inventory_id = inventory.inventory_id
JOIN film_list
ON inventory.film_id = film_list.FID
WHERE customer.first_name = 'PATRICIA' AND customer.last_name = 'JOHNSON'
GROUP BY film_list.category
ORDER BY count(film_list.category) desc 
LIMIT 3;

 /*5. Find out the number of R rated movies rented by “SUSAN WILSON”.*/
 select count(distinct film.film_id)
 from ( (film inner join inventory on film.film_id=inventory.film_id) inner join
 rental on rental.inventory_id=inventory.inventory_id) inner join
 customer on customer.customer_id=rental.customer_id
 where customer.first_name="Susan" and customer.last_name="Wilson" and film.rating="R";
